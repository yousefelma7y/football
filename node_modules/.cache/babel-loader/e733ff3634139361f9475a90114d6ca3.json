{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\n\nvar DragAndDrop =\n/** @class */\nfunction (_super) {\n  __extends(DragAndDrop, _super);\n\n  function DragAndDrop() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.widthUptoCursorPoint = 0;\n    _this.heightUptoCursorPoint = 0;\n    _this.cursorPointIndex = 0;\n    _this.isHeaderRows = false;\n    _this.isTimelineDayProcess = false;\n    _this.widthPerMinute = 0;\n    _this.heightPerMinute = 0;\n    _this.minDiff = 0;\n    _this.isStepDragging = false;\n    _this.isMorePopupOpened = false;\n    _this.isAllDayDrag = false;\n    _this.isMultiSelect = false;\n    _this.multiData = [];\n    _this.updatedData = [];\n    _this.swagData = [];\n    _this.startTime = 0;\n    _this.isAllDayTarget = false;\n    _this.targetTd = null;\n    _this.isCursorAhead = false;\n    return _this;\n  }\n\n  DragAndDrop.prototype.wireDragEvent = function (element) {\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n    var dragObj = new Draggable(element, {\n      abort: '.' + cls.EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  };\n\n  DragAndDrop.prototype.dragHelper = function (e) {\n    var _this = this;\n\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    var elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(function (ele) {\n      var cloneElement = _this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n        _this.actionObj.clone = cloneElement;\n\n        if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' && _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() && !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(_this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n      }\n\n      _this.actionObj.cloneElement.push(cloneElement);\n\n      _this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  };\n\n  DragAndDrop.prototype.dragPosition = function (e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    var cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    var leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    var cloneRight;\n\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    var topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      var top_1 = parseInt(e.top, 10);\n      top_1 = top_1 < 0 ? 0 : top_1;\n      topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n      var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  };\n\n  DragAndDrop.prototype.setDragActionDefaultValues = function () {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  };\n\n  DragAndDrop.prototype.dragStart = function (e) {\n    var _this = this;\n\n    var eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    var dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel || !isNullOrUndefined(_this.actionObj.element) && isNullOrUndefined(_this.actionObj.element.parentElement)) {\n        var dragObj = _this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        _this.actionObj.action = '';\n\n        _this.removeCloneElementClasses();\n\n        _this.removeCloneElement();\n\n        return;\n      }\n\n      _this.actionClass('addClass');\n\n      _this.parent.uiStateValues.action = true;\n      _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n      _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n      _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      _this.actionObj.interval = dragEventArgs.interval;\n      _this.actionObj.navigation = dragEventArgs.navigation;\n      _this.actionObj.scroll = dragEventArgs.scroll;\n      _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n\n      var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      _this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      _this.widthPerMinute = _this.actionObj.cellWidth / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.heightPerMinute = _this.actionObj.cellHeight / _this.actionObj.slotInterval * _this.actionObj.interval;\n      _this.widthUptoCursorPoint = 0;\n      _this.heightUptoCursorPoint = 0;\n      _this.cursorPointIndex = -1;\n      _this.isHeaderRows = false;\n      _this.isTimelineDayProcess = false;\n      _this.minDiff = 0;\n      _this.isMorePopupOpened = false;\n      _this.daysVariation = -1;\n      _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n\n      if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) && _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n          _this.isMorePopupOpened = true;\n        }\n\n        _this.actionObj.pageX = e.event.pageX;\n        var rows = _this.parent.activeViewOptions.headerRows;\n        _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows || _this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        _this.isStepDragging = !_this.isTimelineDayProcess && _this.actionObj.slotInterval !== _this.actionObj.interval;\n\n        if (_this.isTimelineDayProcess) {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n        } else {\n          _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n        }\n      }\n\n      if (_this.parent.currentView === 'TimelineYear') {\n        _this.yearEvent = new YearEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Month') {\n        _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n\n        _this.updateOriginalElement(_this.actionObj.clone);\n\n        _this.monthEvent = new MonthEvent(_this.parent);\n      }\n\n      if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n        _this.verticalEvent = new VerticalEvent(_this.parent);\n      }\n    });\n  };\n\n  DragAndDrop.prototype.getSelectedData = function () {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n        var element = _a[_i];\n        var eventGuid = element.getAttribute('data-guid');\n        var data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  };\n\n  DragAndDrop.prototype.drag = function (e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(cls.DISABLE_DATES)) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      var date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        var currentDate = util.resetTime(date);\n        var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      var targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      var currentTarget = closest(targetElement, '.' + cls.ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    var dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(events.drag, dragArgs);\n  };\n\n  DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    var startDate = eventObj[this.parent.eventFields.startTime];\n    var startTime = this.parent.activeView.renderDates[0];\n    var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE;\n    }\n  };\n\n  DragAndDrop.prototype.dragStop = function (e) {\n    var _this = this;\n\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    var target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    var dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n        _this.parent.crudModule.crudObj.isCrudAction = true;\n        _this.parent.crudModule.crudObj.sourceEvent = [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n\n        var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n\n        _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  };\n\n  DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n    var _this = this;\n\n    if (this.actionObj.navigation.enable) {\n      var currentDate_1 = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(function () {\n          if (currentDate_1) {\n            var crtDate = _this.parent.getCurrentTime();\n\n            var end = crtDate.getSeconds();\n            var start = currentDate_1.getSeconds() + _this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate_1 = _this.parent.getCurrentTime();\n\n              _this.viewNavigation(e);\n\n              _this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.navigationWrapper = function () {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: cls.APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          var elementHeight = this.getAllDayEventHeight();\n          var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event_2[0].offsetHeight < elementHeight) {\n            for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n              var e = event_1[_i];\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      var outWrapper = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!tarWrapper_1) {\n        tarWrapper_1 = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        outWrapper.appendChild(tarWrapper_1);\n      }\n\n      this.actionObj.cloneElement.forEach(function (ele) {\n        tarWrapper_1.appendChild(ele);\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.viewNavigation = function (e) {\n    var navigationType;\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  };\n\n  DragAndDrop.prototype.morePopupEventDragging = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    var dragStart = this.parent.getDateFromElement(td);\n    var dragEnd = new Date(dragStart.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    var eventContainer = td;\n    var eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      var rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  };\n\n  DragAndDrop.prototype.calculateVerticalTime = function (e) {\n    var _this = this;\n\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventStart = eventObj[this.parent.eventFields.startTime];\n    var eventEnd = eventObj[this.parent.eventFields.endTime];\n    var eventDuration = eventEnd.getTime() - eventStart.getTime();\n    var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    var rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    var tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n    } else {\n      var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    var index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    var td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    var dragStart;\n    var dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setMinutes(dragStart.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart.getTime());\n\n      if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart = this.parent.getDateFromElement(td);\n      dragStart.setDate(dragStart.getDate() - this.daysVariation);\n      dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart);\n    this.actionObj.end = new Date(+dragEnd);\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        var targetCellTime_1 = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(function (data) {\n          _this.swagData.push(extend({}, data, null, true));\n\n          if (data[_this.parent.eventFields.isAllDay]) {\n            data[_this.parent.eventFields.startTime] = new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n            var startTime = new Date(data[_this.parent.eventFields.startTime]);\n            var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n            data[_this.parent.eventFields.endTime] = endTime;\n            data[_this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime_1;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        var eventObj_1 = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n      }\n\n      var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n        this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n        var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n\n        if (dayIndex >= 0) {\n          var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n          this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n            remove(this.actionObj.cloneElement[index_1]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  };\n\n  DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.getDayIndex = function (event) {\n    var eventObj = extend({}, event, null, true);\n    var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    var query = '';\n    var wrapper = cls.DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = cls.WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  };\n\n  DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    var datesCount = 0;\n\n    for (var i = 0; i < this.actionObj.groupIndex; i++) {\n      datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n    }\n\n    var target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      var dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[this.actionObj.groupIndex], util.resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      var record = this.verticalEvent.isSpannedEvent(event, dayIndex, this.actionObj.groupIndex);\n      var eStart = record[this.verticalEvent.fields.startTime];\n      var eEnd = record[this.verticalEvent.fields.endTime];\n      var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n      var topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, this.actionObj.groupIndex) : this.actionObj.element.offsetTop;\n\n      if (isNullOrUndefined(index)) {\n        this.actionObj.clone.style.top = formatUnit(topValue);\n        this.actionObj.clone.style.height = formatUnit(appHeight);\n      } else {\n        var appWidth = this.actionObj.cellWidth;\n\n        if (event[this.parent.eventFields.isAllDay]) {\n          topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n          appHeight = this.getAllDayEventHeight();\n          var timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n          var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n          if (allDayDifference >= 0) {\n            appWidth = allDayDifference * this.actionObj.cellWidth;\n          }\n        }\n\n        if (this.actionObj.cloneElement[index]) {\n          this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n          this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n          this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n          this.actionObj.cloneElement[index].style.left = formatUnit(0);\n        }\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n    var _this = this;\n\n    var _a, _b;\n\n    this.parent.eventBase.slots = [];\n    var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    var renderDates = this.parent.activeView.renderDates;\n\n    (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      var resources = this.parent.resourceBase.lastResourceLevel.filter(function (res) {\n        return res.groupIndex === _this.actionObj.groupIndex;\n      });\n      renderDates = resources[0].renderDates;\n\n      (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) {\n        return +date;\n      }));\n    }\n\n    var events = this.parent.eventBase.splitEvent(event, renderDates);\n    var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DragAndDrop.prototype.swapDragging = function (e) {\n    var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      var eventHeight = this.getAllDayEventHeight();\n      var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n          var element = allDayElement_1[_i];\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      var height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  };\n\n  DragAndDrop.prototype.calculateVerticalDate = function (e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    var eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      var tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      var currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        var dragStart = new Date(timeString.getTime());\n        var dragEnd = new Date(dragStart.getTime());\n        var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() - util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime])).getTime();\n        dragStart = new Date(dragStart.getTime() + startTimeDiff);\n        dragEnd = new Date(dragStart.getTime() + eventDuration);\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n\n    for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n      var wrapper = eventWrappers_1[_i];\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n      var startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (var index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  };\n\n  DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n    var eventObj = extend({}, data, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  };\n\n  DragAndDrop.prototype.calculateTimelineTime = function (e) {\n    var eventObj = extend({}, this.actionObj.event, null, true);\n    var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    var rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    var colIndex = this.getColumnIndex(offsetLeft);\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var contentWrapRight = dragArea.getBoundingClientRect().right;\n    var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    var leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n\n    var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    var tr = this.parent.getContentTable().querySelector('tr');\n    var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      var widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      var eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    var eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (var i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      var events_1 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      var eventData = events_1[0].data;\n      var startTime = this.timelineEventModule.getStartTime(events_1[0], eventData);\n      var endTime = this.timelineEventModule.getEndTime(events_1[0], eventData); // eslint-disable-next-line max-len\n\n      var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  };\n\n  DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  };\n\n  DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n    var pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      var targetLeft = tr.children[index].offsetLeft;\n      var pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  };\n\n  DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n    var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  };\n\n  DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n    var index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  };\n\n  DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n    var td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      var targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / util.MS_PER_DAY));\n      } else {\n        var widthDiff = Math.floor(timeDiff / util.MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  };\n\n  DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n    var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    var translateY = util.getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    var rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    var rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    var td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n\n    if (this.parent.rowAutoHeight) {\n      var cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  };\n\n  DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n    if (cloneElement === void 0) {\n      cloneElement = null;\n    }\n\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    var dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  };\n\n  DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n    var eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: cls.APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  };\n\n  DragAndDrop.prototype.getAllDayEventHeight = function () {\n    var eventWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    var eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  };\n\n  DragAndDrop.prototype.isAllowDrop = function (e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    var dropSelectors = this.actionObj.excludeSelectors.split(',');\n    var isAllowDrop = false;\n\n    for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n      var selector = dropSelectors_1[_i];\n\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n\n\n  DragAndDrop.prototype.getModuleName = function () {\n    return 'dragAndDrop';\n  };\n\n  return DragAndDrop;\n}(ActionBase);\n\nexport { DragAndDrop };","map":{"version":3,"sources":["C:/Users/Hardware/Desktop/Train/train/node_modules/@syncfusion/ej2-schedule/src/schedule/actions/drag.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","createElement","closest","Draggable","extend","formatUnit","isNullOrUndefined","addClass","remove","removeClass","setStyleAttribute","ActionBase","MonthEvent","TimelineEvent","YearEvent","VerticalEvent","cls","events","util","MINUTES_PER_DAY","DragAndDrop","_super","_this","apply","arguments","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","isMultiSelect","multiData","updatedData","swagData","startTime","isAllDayTarget","targetTd","isCursorAhead","wireDragEvent","element","dragElement","document","querySelector","parent","eventDragArea","dragObj","abort","EVENT_RESIZE_CLASS","clone","isDragScroll","enableTapHold","isAdaptive","enableTailMode","cursorAt","left","top","dragArea","CONTENT_TABLE_CLASS","dragStart","bind","drag","dragStop","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","e","setDragActionDefaultValues","actionObj","action","elements","allowMultiDrag","selectedElements","length","indexOf","forEach","ele","cloneElement","createCloneElement","getAttribute","currentView","activeViewOptions","timeScale","enable","activeView","isTimelineView","classList","contains","ALLDAY_APPOINTMENT_CLASS","cursor","right","width","style","offsetTop","push","originalElement","cellHeight","slotInterval","interval","leftValue","cloneRight","Math","ceil","getBoundingClientRect","CONTENT_WRAP_CLASS","contentWrapRight","enableRtl","pageX","offsetLeft","topValue","offsetParent","MORE_EVENT_POPUP_CLASS","ALLDAY_ROW_CLASS","offsetWidth","cellWidth","height","pointerEvents","top_1","parseInt","scrollHeight","cloneBottom","offsetHeight","isAllDay","slotCount","workCell","WORK_CELLS_CLASS","eventGuid","event","eventBase","getEventByGuid","eventObj","eventFields","getTime","dragArgs","cancel","data","selectedData","getSelectedData","excludeSelectors","navigation","timeDelay","scroll","scrollBy","trigger","dragEventArgs","parentElement","ej2_instances","intDestroy","removeCloneElementClasses","removeCloneElement","actionClass","uiStateValues","start","end","endTime","groupIndex","viewElement","scrollArgs","scrollWidth","daysVariation","rows","headerRows","option","timelineEventModule","yearEvent","resetTime","Date","updateOriginalElement","monthEvent","verticalEvent","_i","_a","quickPopup","quickPopupHide","target","DISABLE_DATES","eventArgs","getPageCoordinates","Y","pageY","X","abs","calculateMinutesDiff","date","getDateFromElement","currentDate","startDate","MS_PER_DAY","targetElement","currentTarget","ROOT","updateScrollPosition","updateNavigatingPosition","updateDraggingDateTime","group","resources","renderDates","startEndHours","getStartEndHours","getStartHour","getEndHour","startHour","MS_PER_MINUTE","clearInterval","navigationInterval","scrollInterval","isAllowDrop","cellTemplate","getChangedData","allowGroupEdit","rowAutoHeight","virtualScrollModule","byGroupID","crudModule","crudObj","isCrudAction","sourceEvent","resourceBase","lastResourceLevel","currentGroupIndex","targetEvent","saveChangedData","currentDate_1","getCurrentTime","window","setInterval","crtDate","getSeconds","viewNavigation","morePopupEventDragging","dateRender","getSlotDates","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","navigationWrapper","outerWrapperCls","slice","call","querySelectorAll","index","targetWrapper","APPOINTMENT_WRAPPER_CLASS","className","appendChild","wrapperClass","ALLDAY_APPOINTMENT_WRAPPER_CLASS","item","elementHeight","getAllDayEventHeight","event_2","ALLDAY_CELLS_CLASS","event_1","outWrapper","APPOINTMENT_CONTAINER_CLASS","tarWrapper_1","navigationType","scrollEdges","bottom","scrollLeft","round","pageXOffset","clientWidth","changeDate","getNextPreviousDate","eventDuration","td","dragEnd","setMilliseconds","eventContainer","eventWrapper","rowIndex","appendCloneElement","swapDragging","eventStart","eventEnd","floor","scrollTop","pageYOffset","diffInMinutes","tr","trCollections","getContentTable","cellIndex","colIndex","children","getEventWrapper","setMinutes","getMinutes","setDate","getDate","setHours","getHours","addDays","updateAllDayEvents","byDate","undefined","getUpdatedEvent","targetCellTime_1","eventObj_1","startTimeDiff","index_1","updateMultipleData","dayIndex","getDayIndex","wrapper","updateEventHeight","parentNode","updateTimePosition","timeDifference","endTimeDiff","differInDays","day","query","DAY_WRAPPER_CLASS","initializeValues","datesCount","i","getIndexOfDate","record","isSpannedEvent","eStart","fields","eEnd","appHeight","getHeight","getTopValue","appWidth","timeDiff","allDayDifference","endDate","_b","slots","map","filter","res","splitEvent","concat","cell","count","DATE_HEADER_WRAP_CLASS","eventHeight","allDayElement","allDayElement_1","tagName","workCells","timeString","eventWrappers","CLONE_ELEMENT_CLASS","eventWrappers_1","getFullYear","getMonth","updateMultipleVerticalDate","dynamicYearlyEventsRendering","dynamicEventsRendering","setMonth","rightOffset","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cloneIndex","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","calculateIntervalTime","eventSrt","eventsData","dataIndex","events_1","eventData","getStartTime","getEndTime","getEventWidth","getPosition","calculateResourceGroupingPosition","viewEle","pages","targetLeft","getIndex","dateLength","targetDate","currentIndex","trCollection","translateY","getTranslateY","rowHeight","scrollY","isNaN","cursorElement","getCursorElement","APPOINTMENT_CLASS","dropSelectors","split","dropSelectors_1","selector","getModuleName"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { createElement, closest, Draggable, extend, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { ActionBase } from '../actions/action-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport { YearEvent } from '../event-renderer/year';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nvar DragAndDrop = /** @class */ (function (_super) {\n    __extends(DragAndDrop, _super);\n    function DragAndDrop() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.widthUptoCursorPoint = 0;\n        _this.heightUptoCursorPoint = 0;\n        _this.cursorPointIndex = 0;\n        _this.isHeaderRows = false;\n        _this.isTimelineDayProcess = false;\n        _this.widthPerMinute = 0;\n        _this.heightPerMinute = 0;\n        _this.minDiff = 0;\n        _this.isStepDragging = false;\n        _this.isMorePopupOpened = false;\n        _this.isAllDayDrag = false;\n        _this.isMultiSelect = false;\n        _this.multiData = [];\n        _this.updatedData = [];\n        _this.swagData = [];\n        _this.startTime = 0;\n        _this.isAllDayTarget = false;\n        _this.targetTd = null;\n        _this.isCursorAhead = false;\n        return _this;\n    }\n    DragAndDrop.prototype.wireDragEvent = function (element) {\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        var dragObj = new Draggable(element, {\n            abort: '.' + cls.EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: (this.parent.eventDragArea && dragElement) ?\n                dragElement : this.parent.element.querySelector('.' + cls.CONTENT_TABLE_CLASS),\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    };\n    DragAndDrop.prototype.dragHelper = function (e) {\n        var _this = this;\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        var elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach(function (ele) {\n            var cloneElement = _this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === _this.actionObj.element.getAttribute('data-guid')) {\n                _this.actionObj.clone = cloneElement;\n                if (!_this.parent.eventDragArea && _this.parent.currentView !== 'Month' &&\n                    _this.parent.activeViewOptions.timeScale.enable && !_this.parent.activeView.isTimelineView() &&\n                    !_this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(_this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                _this.actionObj.clone.style.top = formatUnit(_this.actionObj.element.offsetTop);\n            }\n            _this.actionObj.cloneElement.push(cloneElement);\n            _this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    };\n    DragAndDrop.prototype.dragPosition = function (e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        var cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        var leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        var cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        var topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            var top_1 = parseInt(e.top, 10);\n            top_1 = top_1 < 0 ? 0 : top_1;\n            topValue = formatUnit(Math.ceil(top_1 / cellHeight) * cellHeight);\n            var scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            var cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    };\n    DragAndDrop.prototype.setDragActionDefaultValues = function () {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    };\n    DragAndDrop.prototype.dragStart = function (e) {\n        var _this = this;\n        var eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        var dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(events.dragStart, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(_this.actionObj.element) &&\n                isNullOrUndefined(_this.actionObj.element.parentElement))) {\n                var dragObj = _this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                _this.actionObj.action = '';\n                _this.removeCloneElementClasses();\n                _this.removeCloneElement();\n                return;\n            }\n            _this.actionClass('addClass');\n            _this.parent.uiStateValues.action = true;\n            _this.actionObj.start = eventObj[_this.parent.eventFields.startTime];\n            _this.actionObj.end = eventObj[_this.parent.eventFields.endTime];\n            _this.actionObj.groupIndex = parseInt(_this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            _this.actionObj.interval = dragEventArgs.interval;\n            _this.actionObj.navigation = dragEventArgs.navigation;\n            _this.actionObj.scroll = dragEventArgs.scroll;\n            _this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            var viewElement = _this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            _this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            _this.widthPerMinute = (_this.actionObj.cellWidth / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.heightPerMinute = (_this.actionObj.cellHeight / _this.actionObj.slotInterval) * _this.actionObj.interval;\n            _this.widthUptoCursorPoint = 0;\n            _this.heightUptoCursorPoint = 0;\n            _this.cursorPointIndex = -1;\n            _this.isHeaderRows = false;\n            _this.isTimelineDayProcess = false;\n            _this.minDiff = 0;\n            _this.isMorePopupOpened = false;\n            _this.daysVariation = -1;\n            _this.isAllDayTarget = _this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n            if ((_this.parent.activeView.isTimelineView() || !_this.parent.timeScale.enable) && _this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(_this.actionObj.clone.offsetParent) &&\n                    _this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n                    _this.isMorePopupOpened = true;\n                }\n                _this.actionObj.pageX = e.event.pageX;\n                var rows = _this.parent.activeViewOptions.headerRows;\n                _this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                _this.isTimelineDayProcess = !_this.parent.activeViewOptions.timeScale.enable || _this.isHeaderRows ||\n                    _this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                _this.isStepDragging = !_this.isTimelineDayProcess && (_this.actionObj.slotInterval !== _this.actionObj.interval);\n                if (_this.isTimelineDayProcess) {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'day');\n                }\n                else {\n                    _this.timelineEventModule = new TimelineEvent(_this.parent, 'hour');\n                }\n            }\n            if (_this.parent.currentView === 'TimelineYear') {\n                _this.yearEvent = new YearEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Month') {\n                _this.startTime = util.resetTime(new Date(_this.startTime)).getTime();\n                _this.updateOriginalElement(_this.actionObj.clone);\n                _this.monthEvent = new MonthEvent(_this.parent);\n            }\n            if (_this.parent.currentView === 'Day' || _this.parent.currentView === 'Week' || _this.parent.currentView === 'WorkWeek') {\n                _this.verticalEvent = new VerticalEvent(_this.parent);\n            }\n        });\n    };\n    DragAndDrop.prototype.getSelectedData = function () {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (var _i = 0, _a = this.parent.selectedElements; _i < _a.length; _i++) {\n                var element = _a[_i];\n                var eventGuid = element.getAttribute('data-guid');\n                var data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    };\n    DragAndDrop.prototype.drag = function (e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(cls.DISABLE_DATES)) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            var date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                var currentDate = util.resetTime(date);\n                var startDate = util.resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            var targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            var currentTarget = closest(targetElement, '.' + cls.ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        var dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(events.drag, dragArgs);\n    };\n    DragAndDrop.prototype.calculateMinutesDiff = function (eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        var startDate = eventObj[this.parent.eventFields.startTime];\n        var startTime = this.parent.activeView.renderDates[0];\n        var startEndHours = util.getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / util.MS_PER_MINUTE);\n        }\n    };\n    DragAndDrop.prototype.dragStop = function (e) {\n        var _this = this;\n        this.isCursorAhead = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        var target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        var dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(events.dragStop, dragArgs, function (dragEventArgs) {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (_this.parent.activeViewOptions.group.resources.length > 0 && !_this.parent.activeViewOptions.group.allowGroupEdit\n                && !_this.parent.rowAutoHeight && !_this.parent.virtualScrollModule && _this.parent.activeViewOptions.group.byGroupID) {\n                _this.parent.crudModule.crudObj.isCrudAction = true;\n                _this.parent.crudModule.crudObj.sourceEvent =\n                    [_this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                var currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || _this.actionObj.groupIndex;\n                _this.parent.crudModule.crudObj.targetEvent = [_this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            _this.saveChangedData(dragEventArgs, _this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    };\n    DragAndDrop.prototype.updateNavigatingPosition = function (e) {\n        var _this = this;\n        if (this.actionObj.navigation.enable) {\n            var currentDate_1 = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(function () {\n                    if (currentDate_1) {\n                        var crtDate = _this.parent.getCurrentTime();\n                        var end = crtDate.getSeconds();\n                        var start = currentDate_1.getSeconds() + (_this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate_1 = _this.parent.getCurrentTime();\n                            _this.viewNavigation(e);\n                            _this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateDraggingDateTime = function (e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(cls.MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    };\n    DragAndDrop.prototype.navigationWrapper = function () {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                var outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                var targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                var wrapperClass = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    var elementHeight = this.getAllDayEventHeight();\n                    var event_2 = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event_2[0].offsetHeight < elementHeight) {\n                        for (var _i = 0, event_1 = event_2; _i < event_1.length; _i++) {\n                            var e = event_1[_i];\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            var outWrapper = void 0;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + cls.APPOINTMENT_CONTAINER_CLASS);\n            }\n            var tarWrapper_1 = outWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!tarWrapper_1) {\n                tarWrapper_1 = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                outWrapper.appendChild(tarWrapper_1);\n            }\n            this.actionObj.cloneElement.forEach(function (ele) {\n                tarWrapper_1.appendChild(ele);\n            });\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.viewNavigation = function (e) {\n        var navigationType;\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    };\n    DragAndDrop.prototype.morePopupEventDragging = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        var dragStart = this.parent.getDateFromElement(td);\n        var dragEnd = new Date(dragStart.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        var eventContainer = td;\n        var eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            var rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    };\n    DragAndDrop.prototype.calculateVerticalTime = function (e) {\n        var _this = this;\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventStart = eventObj[this.parent.eventFields.startTime];\n        var eventEnd = eventObj[this.parent.eventFields.endTime];\n        var eventDuration = eventEnd.getTime() - eventStart.getTime();\n        var offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        var rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        var heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        var diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        var tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS);\n        }\n        else {\n            var trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        var index;\n        if (closest(this.actionObj.target, 'td').classList.contains(cls.WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(cls.ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        var colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        var td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        var dragStart;\n        var dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setMinutes(dragStart.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart.getTime());\n            if (this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart = this.parent.getDateFromElement(td);\n            dragStart.setDate(dragStart.getDate() - this.daysVariation);\n            dragStart.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = util.addDays(util.resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart);\n        this.actionObj.end = new Date(+dragEnd);\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                var targetCellTime_1 = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach(function (data) {\n                    _this.swagData.push(extend({}, data, null, true));\n                    if (data[_this.parent.eventFields.isAllDay]) {\n                        data[_this.parent.eventFields.startTime] =\n                            new Date(data[_this.parent.eventFields.startTime].getTime() + (targetCellTime_1 - _this.startTime));\n                        var startTime = new Date(data[_this.parent.eventFields.startTime]);\n                        var endTime = new Date(startTime.setMinutes(startTime.getMinutes() + _this.actionObj.slotInterval));\n                        data[_this.parent.eventFields.endTime] = endTime;\n                        data[_this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime_1;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                var eventObj_1 = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj_1[this.parent.eventFields.startTime].getTime();\n            }\n            var startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var index_1 = 0; index_1 < this.multiData.length; index_1++) {\n                this.updatedData[index_1] = this.updateMultipleData(this.multiData[index_1], startTimeDiff);\n                var dayIndex = this.getDayIndex(this.updatedData[index_1]);\n                if (dayIndex >= 0) {\n                    var wrapper = this.getEventWrapper(dayIndex, this.updatedData[index_1][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index_1]);\n                    this.updateEventHeight(this.updatedData[index_1], index_1, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index_1].parentNode)) {\n                        remove(this.actionObj.cloneElement[index_1]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    };\n    DragAndDrop.prototype.updateMultipleData = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        var endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            var differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            var day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            var startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = util.resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = util.addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    };\n    DragAndDrop.prototype.getDayIndex = function (event) {\n        var eventObj = extend({}, event, null, true);\n        var startTime = util.resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        var query = '';\n        var wrapper = cls.DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = cls.WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    };\n    DragAndDrop.prototype.updateEventHeight = function (event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        var datesCount = 0;\n        for (var i = 0; i < this.actionObj.groupIndex; i++) {\n            datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n        }\n        var target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            var dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[this.actionObj.groupIndex], util.resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            var record = this.verticalEvent.isSpannedEvent(event, dayIndex, this.actionObj.groupIndex);\n            var eStart = record[this.verticalEvent.fields.startTime];\n            var eEnd = record[this.verticalEvent.fields.endTime];\n            var appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                this.actionObj.element.offsetHeight;\n            var topValue = this.parent.activeViewOptions.timeScale.enable ?\n                this.verticalEvent.getTopValue(eStart, dayIndex, this.actionObj.groupIndex) : this.actionObj.element.offsetTop;\n            if (isNullOrUndefined(index)) {\n                this.actionObj.clone.style.top = formatUnit(topValue);\n                this.actionObj.clone.style.height = formatUnit(appHeight);\n            }\n            else {\n                var appWidth = this.actionObj.cellWidth;\n                if (event[this.parent.eventFields.isAllDay]) {\n                    topValue = this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop;\n                    appHeight = this.getAllDayEventHeight();\n                    var timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                        event[this.parent.eventFields.startTime].getTime();\n                    var allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                    if (allDayDifference >= 0) {\n                        appWidth = (allDayDifference * this.actionObj.cellWidth);\n                    }\n                }\n                if (this.actionObj.cloneElement[index]) {\n                    this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                    this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                    this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                    this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                }\n            }\n        }\n    };\n    DragAndDrop.prototype.updateAllDayEvents = function (startDate, endDate, colIndex) {\n        var _this = this;\n        var _a, _b;\n        this.parent.eventBase.slots = [];\n        var event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        var renderDates = this.parent.activeView.renderDates;\n        (_a = this.parent.eventBase.slots).push.apply(_a, this.parent.activeView.renderDates.map(function (date) { return +date; }));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            var resources = this.parent.resourceBase.lastResourceLevel.\n                filter(function (res) { return res.groupIndex === _this.actionObj.groupIndex; });\n            renderDates = resources[0].renderDates;\n            (_b = this.parent.eventBase.slots).push.apply(_b, renderDates.map(function (date) { return +date; }));\n        }\n        var events = this.parent.eventBase.splitEvent(event, renderDates);\n        var query = \".e-all-day-cells[data-date=\\\"\" + events[0][this.parent.eventFields.startTime].getTime() + \"\\\"]\";\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        var cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            var cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DragAndDrop.prototype.swapDragging = function (e) {\n        var colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + cls.DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            var eventHeight = this.getAllDayEventHeight();\n            var allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (var _i = 0, allDayElement_1 = allDayElement; _i < allDayElement_1.length; _i++) {\n                    var element = allDayElement_1[_i];\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + cls.WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + cls.DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], cls.ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            var height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    };\n    DragAndDrop.prototype.calculateVerticalDate = function (e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            var tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            var workCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            var currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                var timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                var dragStart = new Date(timeString.getTime());\n                var dragEnd = new Date(dragStart.getTime());\n                var startTimeDiff = eventObj[this.parent.eventFields.startTime].getTime() -\n                    (util.resetTime(new Date(+eventObj[this.parent.eventFields.startTime]))).getTime();\n                dragStart = new Date(dragStart.getTime() + startTimeDiff);\n                dragEnd = new Date(dragStart.getTime() + eventDuration);\n                this.actionObj.start = new Date(dragStart.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        var event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        var eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CLONE_ELEMENT_CLASS));\n        for (var _i = 0, eventWrappers_1 = eventWrappers; _i < eventWrappers_1.length; _i++) {\n            var wrapper = eventWrappers_1[_i];\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            var startTime = util.resetTime(new Date(event[this.parent.eventFields.startTime]));\n            var startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (var index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    };\n    DragAndDrop.prototype.updateMultipleVerticalDate = function (data, timeDifference) {\n        var eventObj = extend({}, data, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            var differInDays = Math.ceil(timeDifference / util.MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    };\n    DragAndDrop.prototype.calculateTimelineTime = function (e) {\n        var eventObj = extend({}, this.actionObj.event, null, true);\n        var eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        var offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        var rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        var colIndex = this.getColumnIndex(offsetLeft);\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var contentWrapRight = dragArea.getBoundingClientRect().right;\n        var cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        var leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        var cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        var tr = this.parent.getContentTable().querySelector('tr');\n        var index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        var eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            var widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                var timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if (this.isCursorAhead || cursorDrag) {\n                eventStart.setMinutes(eventStart.getMinutes() +\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n                eventStart.setMilliseconds(-(eventDuration));\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() -\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            var eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        var eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        var eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            var startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (var i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (var dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            var events_1 = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            var eventData = events_1[0].data;\n            var startTime = this.timelineEventModule.getStartTime(events_1[0], eventData);\n            var endTime = this.timelineEventModule.getEndTime(events_1[0], eventData);\n            // eslint-disable-next-line max-len\n            var width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            var day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, util.resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            var left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            var cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    };\n    DragAndDrop.prototype.getOffsetValue = function (offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            var viewEle = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    };\n    DragAndDrop.prototype.getWidthDiff = function (tr, index) {\n        var pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            var targetLeft = tr.children[index].offsetLeft;\n            var pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    };\n    DragAndDrop.prototype.getColumnIndex = function (offsetLeft) {\n        var index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    };\n    DragAndDrop.prototype.getCursorCurrentIndex = function (colIndex, cloneIndex, tr) {\n        var index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            var dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    };\n    DragAndDrop.prototype.cursorIndex = function (e, event, left, index) {\n        var td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            var targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                var currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            var timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (util.MS_PER_DAY)));\n            }\n            else {\n                var widthDiff = Math.floor((timeDiff / util.MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    };\n    DragAndDrop.prototype.calculateResourceGroupingPosition = function (e, cloneElement) {\n        var dragArea = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        var trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        var translateY = util.getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        var rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        var rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        var eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        var eventWrapper = eventContainer.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        var td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        var top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            var cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(cls.WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    cursorElement.offsetParent.classList.contains(cls.APPOINTMENT_CLASS) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    };\n    DragAndDrop.prototype.appendCloneElement = function (element, cloneElement) {\n        if (cloneElement === void 0) { cloneElement = null; }\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        var dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    };\n    DragAndDrop.prototype.getEventWrapper = function (index, isAllDayDrag) {\n        var eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(cls.ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            var wrapperClass = isAllDayDrag ? '.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + cls.APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            var targetWrapper = this.parent.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    };\n    DragAndDrop.prototype.getAllDayEventHeight = function () {\n        var eventWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + cls.ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        var eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    };\n    DragAndDrop.prototype.isAllowDrop = function (e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        var dropSelectors = this.actionObj.excludeSelectors.split(',');\n        var isAllowDrop = false;\n        for (var _i = 0, dropSelectors_1 = dropSelectors; _i < dropSelectors_1.length; _i++) {\n            var selector = dropSelectors_1[_i];\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    DragAndDrop.prototype.getModuleName = function () {\n        return 'dragAndDrop';\n    };\n    return DragAndDrop;\n}(ActionBase));\nexport { DragAndDrop };\n"]},"metadata":{},"sourceType":"module"}